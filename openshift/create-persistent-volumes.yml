---
- hosts: localhost
  vars:
    local_volume_path: /tmp/data01
    owner: apache
    group: apache
  tasks:
    - name: "Create local volume"
      become: true
      file:
        path: "{{ local_volume_path }}"
        state: directory
        owner: apache
        group: apache

    - name: "Create Pulp sub-path"
      become: true
      file:
        path: "{{ local_volume_path }}/pulp"
        state: directory
        mode: 0777

    - name: "Create Puppet sub-path"
      become: true
      file:
        path: "{{ local_volume_path }}/puppet"
        state: directory
        mode: 0777

    - name: "Create Postgresql sub-path"
      become: true
      file:
        path: "{{ local_volume_path }}/postgresql"
        state: directory
        mode: 0777

    - name: "Create MongoDB sub-path"
      become: true
      file:
        path: "{{ local_volume_path }}/mongodb"
        state: directory
        mode: 0777

    - name: "Create persistent volume"
      command: oc create -f volumes/local.yaml
